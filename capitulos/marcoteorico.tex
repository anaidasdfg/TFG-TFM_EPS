%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Plantilla TFG/TFM
% Escuela Politécnica Superior de la Universidad de Alicante
% Realizado por: Jose Manuel Requena Plens
% Contacto: info@jmrplens.com / Telegram:@jmrplens
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\chapter{Marco Teórico}
\label{marcoteorico}
\par A continuación se expone la teoría necesaria para la comprensión de este \gls{tfg}, ampliando la información ya presentada en el capítulo \ref{introduccion}.
\section{Técnicas de regresión y machine learning}
\par Las técnicas de regresión son todas aquellas técnicas que buscan la relación de una variable dependiente con una o más variables independientes mediante la estimación de su función de regresión. Para ello se consideran y ponderan todos los valores de la variable dependiente para unos valores fijos de las variables independientes. Además, en estos análisis, también se tiene en cuenta la varianza de la variable dependiente para estos mismos valores, pudiendo ser estudiada también mediante su distribución de probabilidad. Esta varianza indica la fiabilidad de nuestras estimaciones o el "ruido" en las medidas de la variable dependiente. 
\\
\par El caso más sencillo de regresión es en el que solo tenemos una variable dependiente y otra independiente, este caso se conoce como regresión lineal simple, ya que la función de regresión estimada se corresponde a una ecuación lineal de una recta. Los datos que obtenemos para la variable dependiente que vamos a relacionar tienen, aparte de las componentes lineales, una componente aleatoria de ruido que puede deberse a distintos fenómenos como la precisión mínima del instrumento de medida, el ruido que este mismo general en la medida o contribuciones de fuentes externas, consideradas como ruido también. Esta función de regresión es frecuentemente estimada mediante el \gls{mmc}. También existe la regresión lineal múltiple, que funciona de la misma manera pero con mayor número de variables independientes, por lo que en lugar de una recta, la función de regresión representa un plano en el que coinciden N dimensiones, siendo N el número de variables independientes total. 
\\
\par *Introducir aquí parte analítica regresión lineal*
\\ 
\par Cuando la función de regresión no es una función lineal, la regresión es no lineal, ya que la respuesta de la variable dependiente puede ser exponencial, logarítmica o polinomial, entre otras, por lo que la función de regresión presentará mayor complejidad. Aquí también es común utilizar el \gls{mmc} o la regresión segmentada, que ajusta como regresión lineal segmentos de la original no lineal.
\\
\par Cualquier variable independiente que tenga relación con la dependiente es útil en mayor o menor medida pero siempre proporciona información aunque su varianza sea muy grande o su contribución relativamente pequeña. Cualquier tipo de información extra proporciona un ajuste a la estimación final positivo si esta se ha modelado correctamente. 
\\
\par *Introducir aquí parte analítica regresión no lineal*
\\
\par A parte de las regresiones lineales y no lineales mencionados, también encontramos otros métodos de regresión como son los mínimos errores absoluto (bastante similar al \gls{mmc}), la regresión no paramétrica o la regresión lineal bayesiana.

\par Las técnicas de regresión proporcionan una estimación útil para realizar predicciones, por lo que están relacionados con el aprendizaje automático o machine learning. El machine learning es un tipo de inteligencia artificial, que se caracteriza por la generación de un modelo estimado de manera automática por un computador. Esta estimación se realiza con un entrenamiento previo aplicado a un algoritmo de aprendizaje específico a una serie de datos de entrenamiento. Con este aprendizaje se elabora un modelo que es capaz de devolver una salida o solución a partir de unos parámetros de entrada que deben ser del mismo tipo que los utilizados en la fase de aprendizaje. 
\\
\par * Introducir aquí esquema de ML *
\\
\par Finalmente, el objetivo de las técnicas de machine learning puede ser clasificar una información o realizar una previsión acorde con un modelo estimado. Como se puede ver, el objetivo de este y las técnicas de regresión pueden coincidir y esto lleva a que tienen parte de su desarrollo en común. 

\subsection{Clasificación de técnicas de machine learning}
\par Los modelos empleados en machine learning son numerosos, y su clasificación se puede realizar dependiendo de su algoritmo de aprendizaje y del tipo de razonamiento en el que se basa. Comenzando por la clasificación según su algoritmo de aprendizaje, que principalmente se dividen según el feedback  del que aprenden, los modelos se pueden clasificar de la siguiente manera \cite{MLRussell}: 
\begin{itemize}
	\item Aprendizaje no supervisado: este aprendizaje se basa en la clasificación o agrupación de los objetos de entrada según patrones que cumplen las distintas entradas de estos. Estos métodos no devuelven un nombre específico para cada grupo o cluster ya que no se le han proporcionado referencias o etiquetas en la etapa de entrenamiento. Necesita numerosas entradas en el entrenamiento para detectar patrones suficientemente estables. 
	\item Aprendizaje por refuerzo: el aprendizaje se realiza por refuerzo positivo, que sería una recompensa, o negativo, penalización. Este algoritmo buscaría la estimación del modelo para obtener el máximo refuerzo positivo posible. Así, tras suficiente entrenamiento construye un modelo muy preciso para nuevas entradas. 
	\item Aprendizaje supervisado: tanto las entradas como las salidas están previamente definidas en la etapa de aprendizaje. Se realiza un entrenamiento en el que se utilizan las entradas con sus correspondientes salidas para elaborar el modelo. Una vez suficientemente entrenado, este puede obtener salidas previamente desconocidas a partir de entradas similares a las del entrenamiento. 
	\item Aprendizaje semi-supervisado: este aprendizaje recibe algunas de sus entradas correctamente etiquetadas y el resto de ellas, la mayoría, sin etiquetar, así tiene algunas referencias para la clasificación fiables pero no toma las etiquetas como una referencia totalmente cierta para toda la clasificación como ocurre en el aprendizaje supervisado. Así se evitan malos aprendizajes por ruido o etiquetas erróneas en los datos de entrada. Bastante común en grandes masas de datos para aprendizaje. 
\end{itemize}
\par Por otra parte, teniendo en cuenta la base de los razonamientos internos que los algoritmos realizan para obtener las salidas correspondientes, aunque no considerando esta división estricta, las técnicas se pueden clasificar de la siguiente manera \cite{MLFlach}:
\begin{itemize}
	\item Geométricos: los modelos geométricos son aquellos cuyos objetos pueden ser representados en un espacio de instancias (X) en el que cada instancia corresponde a un posible objeto, esto es, habrá tantas instancias como objetos con distintas combinaciones de entradas posibles. Por otra parte, las etiquetas también se representan como un espacio de etiquetas (Y) con un número finito de posibilidades \citep{MLPref}. Utilizando estos conceptos, el algoritmo se desarrolla con otros conceptos geométricos como son líneas, planos y distancias. Estos métodos suelen ser aplicados cuando X e Y están formados por valores numéricos, que son fácilmente representables en ejes de coordinadas.
	\item Probabilísticos: los modelos probabilísticos parten de la base de que las entradas de los objetos están basadas en un proceso aleatorio que hacen referencia a una distribución de probabilidad desconocida. Se busca definir esa distribución P(Y|X), siendo X el conjunto de objetos posibles e Y las etiquetas correspondientes. Aquí el modelo tendría como salidas probabilidades para cada una de las opciones posibles. 
	\item Lógicos: los modelos lógicos son los más cercanos al razonamiento humano y los más comprensibles también como algoritmos. Se basan en decisiones lógicas, estructuradas típicamente en forma de árbol, esto es llamado árbol de decisiones y según las características de los parámetros de entrada nos vamos desplazando hacia la base del árbol, obteniendo al final una única salida para cada objeto de entrada. *Introducir esquema*
	\item Agrupaciones y gradiente: estos modelos se incluyen en los anteriores, ya que es una clasificación paralela según el tratamiento del espacio de instancias (X): agrupaciones seccionando estos espacios en un número de segmentos definido, fácilmente representables y con una única solución, en cambio; en los gradientes, no existe una segmentación previamente definida, por lo que el modelo trata todo el espacio como uno solo. 
\end{itemize}

\subsection{Modelos de machine learning y aplicaciones}
\par Una vez presentadas todas las posibles clasificaciones de técnicas de machine learning, podemos adentrarnos en los modelos más comunes, a qué tipo de los anteriores pertenecen y cuáles son sus aplicaciones más usuales y en las que son más efectivos. Algunos de los más conocidos son los siguientes:
\begin{itemize}
	\item Redes neuronales artificiales: este modelo es de tipo geométrico y de aprendizaje supervisado, ya que el entrenamiento consta de entradas etiquetadas con su correspondiente salida. Este modelo se caracteriza por estar inspirado por las redes neuronales naturales del cerebro animal, obteniendo resultados sin unas reglas preestablecidas de análisis. Estas redes están compuestas por capas de neuronas, las cuales representan un peso y una función de activación por la que una parte de la información de entrada se va a procesar. Estas funciones y pesos se van ajustando mediante el entrenamiento hasta tener una red óptima para su funcionamiento. En cuanto a aplicaciones, la más común de este modelo es el reconocimiento en imágenes de objetos o caracteres. Cuando analizamos imágenes cada unidad de información a la entrada para un objeto está formada por un pixel, y cada capa de neuronas irá reconociendo formas, colores, etc. hasta devolver la clasificación que corresponde a ese objeto de entrada. 
	\item Árboles de decisión: es un modelo lógico y de aprendizaje supervisado. Es lo de los modelos lógicos más ilustrativos porque se basa en árboles que siguen las reglas de decisión, yendo desde el primer nodo donde se sitúa la entrada resolviendo condiciones de estas hasta llegar a una única salida, alcanzable por un camino único, que es la salida del modelo. En el aprendizaje, este modelo va ajustando sus condiciones y elaborando el árbol más coherente para llegar a las soluciones necesarias. Este método es bastante sencillo de implementar y comprender, por lo que las aplicaciones son diversas. Relacionado con ese modelo también encontramos el conocido como \gls{rf}, anteriormente mencionado. Este modelo se caracteriza por generar numerosos árboles de decisión provenientes de un factor aleatorio con la misma distribución. Al obtener los resultados de cada uno de los árboles, se realiza un promediado, tomando la respuesta más repetida como la más probable y teniendo en cuenta el resto en su correspondiente porcentaje. De esta manera, un modelo que era limitado a una respuesta única, se abre devolviendo una respuesta probabilística. 
	\item Máquinas de vectores de soporte: es un modelo geométrico y supervisado. Este modelo geométrico utiliza el espacio de instancias para representar los objetos de entrenamiento como puntos y las clases o salidas como líneas o hyperplanos, dependiendo del número de dimensiones, lo más separados posibles unos de otros. Una vez ajustado este modelo, las nuevas entradas se clasificarán según al espacio al que pertenezcan. Este modelo está muy relacionado con la clasificación/agrupación y la regresión. Algunas de sus aplicaciones son el reconocimiento de caracteres escritos a mano \cite{MLhand} y clasificación de textos \citep{MLText}, la clasificación de imágenes por segmentación \citep{MLimg} o, el más interesante para este proyecto, la clasificación de información procedente de un \gls{sar} \citep{MLSAR}
	\item Redes bayesianas: es un modelo probabilístico y gráfico, a la vez que lógico, de aprendizaje supervisado. Se basa en un modelo gráfico de nodos que corresponden a variables conocidas o desconocidas y el tratamiento probabilístico simplificado con la regla de la cadena. Son muy utilizadas en aplicaciones relacionadas con las ciencias de la salud para modelar comportamientos biológicos. 
	\item Algoritmos genéticos: son algoritmos basados en la genética biológica. Estos comienzan con unas muestras aleatorias de posibles salidas, se evalúan y se realizan una serie de transformaciones que incluyen la selección de los mejores resultados, su recombinación y alteración de algunos para volver a empezar con la siguiente entrada, así hasta tener un modelo estable, fiable y calibrado. Este modelo se utiliza bastante para análisis y predicciones.
	\item También se consideran, entre otros métodos, los análisis de regresión. Técnicas que se pueden aplicar como hemos visto anteriormente al machine learning, ya que comparten un mismo objetivo. 
\end{itemize}

\section{Teledetección}
\par Conociendo el significado de esta parte de las telecomunicaciones de una manera general, en este apartado se van a explicar conceptos más concretos de cómo funciona esta tecnología, qué tipos existen y qué técnicas se emplean en teledetección. 
\\
\par Como ya se menciona en el capítulo \ref{introduccion}, los instrumentos de teledetección se caracterizan por medir la radiación electromagnética emitida o reflejada por un objeto o superficie que se encuentra a distancia del mismo. Estos instrumentos se pueden clasificar en dos tipos: pasivos, miden la radiación natural emitida o reflejada por el objeto observado, o activos, emiten energía que posteriormente será reflejada y detectada.
\\
\par Algunos de estos instrumentos son cámaras fotográficas, láseres o radares. Todos ellos trabajan en un determinado espacio en el espectro electromagnético, dependiendo de lo que quieran captar, por ejemplo los sensores ópticos necesitan trabajar en frecuencias del espectro visible, mientras que los radares pueden trabajar a frecuencias de microondas.
\subsection{Tecnología radar}
\par Para este proyecto, nos vamos a centrar en el instrumento llamado radar, que es el que vamos a utilizar. Se trata de un instrumento activo, que trabaja en el espectro de las microondas, concretamente entre 1-40 GHz. Por ello, son sensores sensibles a objetos del tamaño de sus longitudes de onda, es decir entre 30-0.75 cm, mucho mayores que los ópticos. Además, otras ventajas frente a estos es su penetración en nubosidades, por lo que el tiempo atmosférico, en general, no supone un impedimento para la captación de información, como sucede en los sensores ópticos, esto también se debe a la mayor longitud de onda.
\\
\par Al tratarse de un instrumento activo, este también ilumina con pulsos electromagnéticos el área a observar, emitidos por una antena propia, por lo que no depende de fuentes externas de radiación, esto es que, incluso objetos que no emitan radiación ni reflejen de otras fuentes, se podrán detectar gracias a la reflexión de esta incidencia. 
\\ 
\par La información que se obtiene en una antena receptora (o la misma emisora con doble función) de esta reflexión es otra onda electromagnética de la cual se puede medir su potencia, fase y polarización para obtener información útil del área observada. Para todas ellas deben tenerse en cuenta parámetros adicionales que influyen durante el trayecto del pulso, como es el retardo de fase o las pérdidas de potencia. 
\\
\par La potencia recibida ($P_{R}$) se puede considerar como la contribución de los siguientes parámetros: potencia transmitida ($P_{T}$), longitud de onda ($\lambda$), ganancia de la antena ($G$), pérdidas en sistema ($L_{s}$) y en atmósfera ($L_{a}$), la longitud del trayecto ($R$), la superficie del área observada ($S$) y, por último, el coeficiente de backscattering ($\sigma_{0}$), teniendo en cuenta ambos trayectos de ida y vuelta y la propagación esférica de la onda, como se muestra en las siguientes fórmulas. 
\\
\par *Aquí introducir fórmula PR*
\\
\par Como podemos observar, el parámetro más interesante que nos va a dar información sobre el área observada es el coeficiente de backscattering. Este parámetro es un valor adimensional (dB) que representa la relación entre la proporción de área equivalente si el objeto observado fuera un blanco isótropo (reflexión total) ($m_{2}$) y su área o superficie observada real ($m_{2}$). 
\subsection{Satélites en teledetección}
\subsection{Técnicas de detección}
\section{Estimación de parámetros físicos de cultivos mediante regresión}
 